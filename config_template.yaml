# ============================================================================
#
#   _phytoclass_Shiny V1.0 - CONFIGURATION TEMPLATE
#
#   Description:
#   This is the read-only default template. User settings are saved to
#   'config_session.yaml'. 
#
#   This file defines the standard columns, algorithm defaults, and
#   color palettes used for plotting.
#
# ============================================================================

general:
  project_name: PhytoclassShiny_Project
  config_version: 1.0
  # Metadata keys are non-pigment columns essential for context.
  metadata_keys: [latitude, longitude, depth, year, month, day, date, time, internal_source_id, Tchla]
  # Essential pigments required for the core algorithm to run.
  essential_pigments: [Dvchla, Chl_b, Chl_c1, Chl_c3, Per, X19but, Fuco, X19hex, Pra, Viol, Allo, Zea, Lut, Neox]

workspace:
  # Default paths relative to the application's root directory.
  output_directory: phyto_output/
  fm_pro_matrix_path: R/Fm_matrices/Fm_Pro.xlsx
  fm_nopro_matrix_path: R/Fm_matrices/Fm_NoPro.xlsx
  
column_aliases:
  # Maps standard internal keys (left) to a list of possible column names
  # found in raw data files (right).
  latitude: [latitude, lat, Lat, LATITUDE, "Lat.", Latitude]
  longitude: [longitude, Longitude, lon, Lon, long, Long, LONGITUDE, "Lon."]
  depth: [depth, Depth, depth_m, Depth_m, "Depth (m)"]
  year: [year, Year, YEAR, YR]
  month: [month, Month, MONTH, MON]
  day: [day, Day, DAY, DY]
  date: [date, Date, DATE, SampleDate, sample_date, Sampling_date_UTC]
  time: [time, Time, TIME, SampleTime, sample_time, Sampling_time_UTC]
  internal_source_id: [sample_id, station_id, Sample_num, Station, Site, Sample_code, cruise, Cruise]
  Tchla: [Tchla, Total_Chlorophyll_a, Total.Chlorophyll.a, "TChl a", "Total Chla", "Total_Chla", "TChl a"]
  Dvchla: [Dvchla, DVchla, Divinyl_Chlorophyll_a, "DVChla ", DVChl_a, "DVChl_a ", "DV chl a "]
  Chl_b: [Chl_b, TChlb, Chlorophyll_b, "Chlb ", Chl.b, "Chl_b ", "Chl b "]
  Chl_c1: [Chl_c1, Chl_c1c2, "Chlc1 ", "Chlc1+c2 ", "Chl_c1c2 ", "Chl c1+c2 "]
  Chl_c3: [Chl_c3, Chlorophyll_c3, "Chlc3 ", "Chl_c3 ", "Chl c3 "]
  Per: [Per, Perid, Peri, "Perid ", "Peri ", "Perid "]
  X19but: [X19but, "19'-Butanoyloxyfucoxanthin", "19But ", But, "19'-But", "But ", "But-fuco "]
  Fuco: [Fuco, Fucoxanthin, "Fucox ", Fucox, "Fuco ", "Fuco "]
  X19hex: [X19hex, Hex, "19Hex ", "19'-Hex", "Hex ", "Hex-fuco "]
  Pra: [Pra, Pras, Prasino, Prasinoxanthin, "Prasino ", "Pras ", "Pras "]
  Viol: [Viol, Violaxanthin, "Violax ", Violax, "Violax ", "Viola "]
  Allo: [Allo, Alloxanthin, "Allox ", "Allox ", "Allo "]
  Zea: [Zea, Zeaxanthin, "Zeax ", Zeax, "Zea ", "Zea "]
  Lut: [Lut, Lutein, "Lutein ", "Lutein ", "Lut "]
  Neox: [Neox, Neoxanthin, "Neox ", Neo, "Neo ", "Neo "]

filtering:
  # Default states for metadata-based filtering rules.
  geospatial: {enabled: false, min_latitude: -90, max_latitude: 90, min_longitude: -180, max_longitude: 180}
  temporal: {enabled: false, start_date: '1900-01-01', end_date: '2030-01-01'}
  depth: {enabled: false, min_depth: 0, max_depth: 2000}

data_cleaning:
  # Default states for data quality control rules.
  handle_duplicates: {enabled: true}
  handle_pigment_nas: {enabled: true}
  handle_zero_pigment_sum: {enabled: true}
  enforce_non_negative_pigments: {enabled: true}

clustering:
  # Parameters for the advanced clustering workflow (Step 5).
  # --- Pre-processing Pipeline ---
  imputation_method: 'none'         # Options: 'none', 'max', 'min'
  normalization_method: 'tchla'     # Options: 'none', 'tchla'
  transformation_method: 'log1p'    # Options: 'none', 'log1p'

  # --- Algorithm Settings ---
  cluster_method: 'hclust'          # Options: 'hclust', 'kmeans'
  # Distance is locked to 'euclidean' in the app logic for stability with Log data
  distance_method: 'euclidean'      
  
  # --- Algorithm Parameters ---
  k_max: 5                          # Max clusters to test or specific k to use

phytoclass:
  # Default parameters for the core phytoclass algorithm (Step 6).
  niter: 500
  step_size: 0.009

performance:
  # Used to calculate the ETA progress bar. 
  # This value (seconds per sample) updates dynamically after every successful run.
  avg_speed: 0.5

reporting:
  generate_master_summary: true
  
  # --- Visualization Settings ---
  # IMPORTANT: The keys below must match the row names in your Fm_Pro/Fm_NoPro
  # Excel files exactly. R often converts hyphens to dots, so we include both.
  plotting:
    custom_palette:
      # --- Red Group (Diatoms) ---
      Diatoms-1: "#CC0000"        # Dark Red
      Diatoms-2: "#FF0000"        # Bright Red
      Diatoms.1: "#CC0000"        # Catch for R 'make.names'
      Diatoms.2: "#FF0000"        # Catch for R 'make.names'
      Diatoms: "#FF0000"          # Catch for generic
      
      # --- Orange Group (Dinoflagellates) ---
      Dinoflagellates-1: "#ED7D31" # Orange
      Dinoflagellates-2: "#F4B084" # Light Orange
      Dinoflagellates.1: "#ED7D31" 
      Dinoflagellates: "#ED7D31"
      
      # --- Brown Group (Cryptophytes) ---
      Cryptophytes: "#B45F04"     # Rust/Brown
      
      # --- Yellow Group (Pelagophytes/Chrysophytes) ---
      Pelagophytes: "#FFC000"     # Gold/Yellow
      Chrysophytes: "#FFD700"     # Gold
      
      # --- Purple/Pink Group (Haptophytes) ---
      Haptophytes: "#7030A0"      # Deep Purple
      Haptophytes-6: "#9933FF"    # Light Purple
      Haptophytes-8: "#7030A0"    # Deep Purple
      Haptophytes.6: "#9933FF"
      Haptophytes.8: "#7030A0"
      Prymnesiophytes: "#7030A0"
      
      # --- Green Group (Green Algae) ---
      Prasinophytes: "#70AD47"    # Light/Grass Green
      Chlorophytes: "#006400"     # Dark/Forest Green
      Euglenophytes: "#339933"    # Medium Green
      
      # --- Cyan/Blue Group (Cyanobacteria) ---
      Syn: "#00B0F0"              # Cyan (Synechococcus)
      Synechococcus: "#00B0F0"
      Pro: "#0070C0"              # Darker Blue (Prochlorococcus)
      Prochlorococcus: "#0070C0"
      Cyanobacteria: "#00B0F0"